{% extends "index.html" %}

{% block title %}Documentation - Telegram Security Bot{% endblock %}

{% block content %}
<div class="card">
    <h2>üìñ Telegram Security Bot Documentation</h2>
    <p>Complete guide for setting up and using the Telegram Security Bot</p>
</div>

<div class="card">
    <h3>üöÄ Quick Start</h3>
    <ol style="margin-left: 20px;">
        <li>Get your Telegram Bot Token from @BotFather</li>
        <li>Set environment variables (see Configuration page)</li>
        <li>Deploy to Render.com or run locally</li>
        <li>Add the bot to your Telegram groups</li>
        <li>Start protecting your users from malicious URLs!</li>
    </ol>
</div>

<div class="card">
    <h3>ü§ñ Bot Commands</h3>
    <div style="margin-top: 15px;">
        <h4>User Commands:</h4>
        <ul style="margin-left: 20px;">
            <li><code>/start</code> - Welcome message and bot introduction</li>
            <li><code>/help</code> - Show available commands and features</li>
            <li><code>/scan &lt;url&gt;</code> - Manually scan a specific URL</li>
            <li><code>/settings</code> - View current chat settings (admins only)</li>
        </ul>
        
        <h4 style="margin-top: 20px;">Admin Commands:</h4>
        <ul style="margin-left: 20px;">
            <li><code>/admin</code> - Show admin panel</li>
            <li><code>/addadmin &lt;user_id&gt;</code> - Add a new admin</li>
            <li><code>/removeadmin &lt;user_id&gt;</code> - Remove an admin</li>
            <li><code>/ban &lt;user_id&gt;</code> - Ban a user from using the bot</li>
            <li><code>/unban &lt;user_id&gt;</code> - Unban a user</li>
            <li><code>/whitelist &lt;domain&gt;</code> - Add domain to whitelist</li>
            <li><code>/blacklist &lt;domain&gt;</code> - Add domain to blacklist</li>
            <li><code>/stats</code> - View bot usage statistics</li>
        </ul>
    </div>
</div>

<div class="card">
    <h3>üõ°Ô∏è Security Features</h3>
    <ul style="margin-left: 20px;">
        <li><strong>Automatic URL Scanning:</strong> Scans all URLs shared in monitored chats</li>
        <li><strong>Multi-Source Analysis:</strong> Uses URLScan.io and Cloudflare Radar for comprehensive threat detection</li>
        <li><strong>Threat Scoring:</strong> Weighted scoring system combining multiple security intelligence sources</li>
        <li><strong>Real-time Alerts:</strong> Immediate notifications for detected threats</li>
        <li><strong>Admin Controls:</strong> Hierarchical permission system with multiple admin levels</li>
        <li><strong>Rate Limiting:</strong> Built-in protection against API abuse</li>
        <li><strong>Whitelist/Blacklist:</strong> Custom domain filtering capabilities</li>
    </ul>
</div>

<div class="card">
    <h3>‚öôÔ∏è Configuration Options</h3>
    <div style="margin-top: 15px;">
        <h4>Chat Settings:</h4>
        <ul style="margin-left: 20px;">
            <li><strong>Auto-scan:</strong> Enable/disable automatic URL scanning</li>
            <li><strong>Auto-delete threats:</strong> Automatically delete messages with high-threat URLs</li>
            <li><strong>Threat threshold:</strong> Minimum score to trigger alerts (0-100)</li>
            <li><strong>Scan timeout:</strong> Maximum time to wait for scan results</li>
        </ul>
        
        <h4 style="margin-top: 20px;">API Configuration:</h4>
        <ul style="margin-left: 20px;">
            <li><strong>URLScan.io weight:</strong> Influence of URLScan results on final score (default: 60%)</li>
            <li><strong>Cloudflare weight:</strong> Influence of Cloudflare results on final score (default: 30%)</li>
            <li><strong>Heuristic weight:</strong> Influence of built-in heuristics on final score (default: 10%)</li>
        </ul>
    </div>
</div>

<div class="card">
    <h3>üîß Deployment</h3>
    
    <h4>Render.com Deployment:</h4>
    <ol style="margin-left: 20px;">
        <li>Fork this repository to your GitHub account</li>
        <li>Connect your GitHub account to Render.com</li>
        <li>Create a new Web Service</li>
        <li>Set the build command: <code>pip install -r requirements.txt</code></li>
        <li>Set the start command: <code>python web_interface.py</code></li>
        <li>Add environment variables in the Render dashboard</li>
        <li>Deploy and monitor via the web interface</li>
    </ol>
    
    <h4 style="margin-top: 20px;">Local Development:</h4>
    <pre>
# Clone repository
git clone &lt;repository-url&gt;
cd telegram-security-bot

# Install dependencies
pip install -r requirements.txt

# Set environment variables
export TELEGRAM_BOT_TOKEN="your_token"
export URLSCAN_API_KEY="your_key"
export CLOUDFLARE_API_KEY="your_key"

# Run the bot
python main.py

# Run web interface (separate terminal)
python web_interface.py</pre>
</div>

<div class="card">
    <h3>üìä Monitoring</h3>
    <ul style="margin-left: 20px;">
        <li><strong>Web Dashboard:</strong> Real-time status monitoring via web interface</li>
        <li><strong>Health Check:</strong> <code>/health</code> endpoint for uptime monitoring</li>
        <li><strong>API Status:</strong> <code>/api/status</code> endpoint for service status</li>
        <li><strong>Logging:</strong> Comprehensive logging with rotation and error tracking</li>
        <li><strong>Statistics:</strong> Usage statistics and performance metrics</li>
    </ul>
</div>

<div class="card">
    <h3>üÜò Troubleshooting</h3>
    
    <h4>Common Issues:</h4>
    <div style="margin-top: 10px;">
        <p><strong>Bot not responding:</strong></p>
        <ul style="margin-left: 20px;">
            <li>Check TELEGRAM_BOT_TOKEN is correct</li>
            <li>Verify bot is started and not banned</li>
            <li>Check network connectivity</li>
        </ul>
        
        <p style="margin-top: 15px;"><strong>URL scanning not working:</strong></p>
        <ul style="margin-left: 20px;">
            <li>Verify API keys are configured correctly</li>
            <li>Check API quota limits</li>
            <li>Ensure auto-scan is enabled for the chat</li>
        </ul>
        
        <p style="margin-top: 15px;"><strong>Web interface not accessible:</strong></p>
        <ul style="margin-left: 20px;">
            <li>Check PORT environment variable</li>
            <li>Verify Render.com deployment settings</li>
            <li>Check application logs for errors</li>
        </ul>
    </div>
</div>

<div style="text-align: center; margin-top: 30px;">
    <a href="{{ url_for('index') }}" class="btn">‚Üê Back to Dashboard</a>
    <a href="{{ url_for('config_page') }}" class="btn">‚öôÔ∏è Configuration</a>
</div>
{% endblock %}
